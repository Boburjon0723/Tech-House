<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savat - Tech House</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/savat.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>

<body>
    <!-- Header -->
    <header>
        <nav>
            <a href="./index.html" class="logo">Tech House</a>
            <ul class="nav-links">
                <li><a href="./index.html#home">Bosh sahifa</a></li>
                <li><a href="./xizmatlar.html">Xizmatlar</a></li>
                <li><a href="./aksiyalar.html">Aksiyalar</a></li>
                <li><a href="./boglanish.html">Bog'lanish</a></li>
            </ul>
            <div class="header-actions">
                <a href="./savat.html" class="cart-icon">
                    <span><i class="bi bi-cart-plus"></i></span>
                    <span class="cart-count">0</span>
                </a>
                <a href="./auth.html" class="menu-icon">
                    <span><i class="bi bi-person-circle"></i></span>
                </a>
                <button class="mobile-nav-toggle">
                    <i class="bi bi-list"></i>
                </button>
            </div>
        </nav>
    </header>

    <main class="container my-5">
        <h1 class="mb-4">Sizning Savatingiz</h1>
        <div class="row">
            <!-- Savatdagi mahsulotlar -->
            <div class="col-lg-8">
                <div id="cart-items-container" class="cart-items-list mb-4">
                    <!-- Mahsulotlar JS orqali qo'shiladi -->
                    <div class="empty-cart-message text-center py-5">
                        <i class="bi bi-cart-x display-1 text-muted"></i>
                        <h3 class="mt-3">Savatingiz bo'sh</h3>
                        <p>Hozircha hech narsa qo'shmadingiz</p>
                        <a href="./index.html#products" class="btn btn-primary mt-3">Xaridni davom ettirish</a>
                    </div>
                </div>
            </div>

            <!-- Buyurtma xulosasi -->
            <div class="col-lg-4">
                <div class="cart-summary-card p-4">
                    <h3>Buyurtma Xulosasi</h3>
                    <div class="summary-details mt-4">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Mahsulotlar:</span>
                            <span id="cart-subtotal">0 so'm</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Yetkazib berish:</span>
                            <span id="cart-delivery">Bepul</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between mb-4">
                            <strong>Jami:</strong>
                            <strong id="cart-grand-total" class="fs-4 text-primary">0 so'm</strong>
                        </div>
                        <a href="./checkout.html" class="btn btn-success w-100 py-3 fw-bold">To'lovga o'tish</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Tech House</h3>
                    <p>O'zbekistondagi eng ishonchli uy jihozlari va maishiy texnika do'koni. Sifat va qulay narxlar
                        kafolati!</p>
                </div>
                <!-- ... Qolgan footer qismlari ... -->
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Tech House. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./js/script.js"></script>
    <script>
        // Savat sahifasi uchun maxsus funksiyalar
        document.addEventListener('DOMContentLoaded', () => {
            renderCartPage();
        });

        function renderCartPage() {
            const container = document.getElementById('cart-items-container');
            const subtotalEl = document.getElementById('cart-subtotal');
            const grandTotalEl = document.getElementById('cart-grand-total');

            let cart = JSON.parse(localStorage.getItem('techhouse_cart')) || [];

            if (cart.length === 0) {
                return; // Empty message is already in HTML
            }

            container.innerHTML = '';
            let total = 0;

            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                container.innerHTML += `
                    <div class="cart-item-card mb-3 p-3 border rounded shadow-sm bg-white">
                        <div class="row align-items-center">
                            <div class="col-md-2 col-4">
                                <img src="${item.image}" alt="${item.name}" class="img-fluid rounded">
                            </div>
                            <div class="col-md-5 col-8">
                                <h5 class="mb-1">${item.name}</h5>
                                <p class="text-muted mb-0 small">${item.price.toLocaleString()} so'm</p>
                            </div>
                            <div class="col-md-3 col-7 mt-3 mt-md-0">
                                <div class="input-group">
                                    <button class="btn btn-outline-secondary" onclick="updateQty(${index}, -1)">-</button>
                                    <input type="text" class="form-control text-center" value="${item.quantity}" readonly>
                                    <button class="btn btn-outline-secondary" onclick="updateQty(${index}, 1)">+</button>
                                </div>
                            </div>
                            <div class="col-md-2 col-5 mt-3 mt-md-0 text-end">
                                <strong class="text-primary">${itemTotal.toLocaleString()} so'm</strong>
                                <button class="btn btn-link text-danger p-0 ms-2" onclick="removeItem(${index})">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            subtotalEl.textContent = total.toLocaleString() + " so'm";
            grandTotalEl.textContent = total.toLocaleString() + " so'm";
        }

        function updateQty(index, change) {
            let cart = JSON.parse(localStorage.getItem('techhouse_cart')) || [];
            cart[index].quantity += change;
            if (cart[index].quantity < 1) cart[index].quantity = 1;
            localStorage.setItem('techhouse_cart', JSON.stringify(cart));
            renderCartPage();
            if (typeof updateCartDisplay === 'function') updateCartDisplay();
        }

        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem('techhouse_cart')) || [];
            cart.splice(index, 1);
            localStorage.setItem('techhouse_cart', JSON.stringify(cart));
            renderCartPage();
            if (typeof updateCartDisplay === 'function') updateCartDisplay();
            if (cart.length === 0) location.reload();
        }
    </script>
</body>

</html>